Https原理
--

# 需要解决的问题，
非对称加密费时间，所以用非对称加密交换密钥，以后的流程走对称加密。非对称加密中传输的公钥用于加密，公开也没关系，但是如果第三方截取替换其他的公钥？所以需要公钥合法性，才有了证书。



--

# 客户端如何校验 CA 证书？
CA 证书中的 Hash 值，其实是用证书的私钥进行加密后的值（证书的私钥不在 CA 证书中）。然后客户端得到证书后，利用证书中的公钥去解密该 Hash 值，得到 Hash-a ；然后再利用证书内的签名 Hash 算法去生成一个 Hash-b 。最后比较 Hash-a 和 Hash-b 这两个的值。如果相等，那么证明了该证书是对的，服务端是可以被信任的；如果不相等，那么就说明该证书是错误的，可能被篡改了，浏览器会给出相关提示，无法建立起 HTTPS 连接。除此之外，还会校验 CA 证书的有效时间和域名匹配等。



--

# 大体流程


- 浏览器向服务器发送请求，请求中包括浏览器支持的协议，并附带一个随机数。


- 服务器收到请求后，选择某种非对称加密算法，把数字证书签有公钥、身份信息发送给浏览器，同时也附带一个随机数。


- 浏览器收到后、验证证书的真实性，用服务器的公钥发送握手信息给服务器。


- 服务器解密后 使用主前的随机数计算出，个对称加密的密钥 以此作为加密信息并发送。


- 后续所有的信息发送都是以对称加密方式进行的。

